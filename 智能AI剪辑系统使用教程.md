
# 🎬 智能AI电视剧剪辑系统 - 完整使用教程

## 🚀 系统简介

这是一个基于AI技术的智能电视剧剪辑系统，能够自动分析电视剧字幕内容，智能识别精彩片段，并生成高质量的短视频。

### ✨ 核心特性

- **🤖 智能AI分析**: 完全解放人工，AI自动识别剧情类型和精彩片段
- **📖 整集上下文分析**: 避免剧情割裂，保持故事连贯性
- **🎬 多片段自动剪辑**: 每集自动生成3-5个精彩短视频
- **🎙️ 专业旁白生成**: 自动生成剧情解说和字幕提示
- **💾 智能缓存机制**: 避免重复API调用，支持断点续传
- **🔗 剧情连贯保证**: 确保所有短视频能完整讲述剧情

## 📁 文件结构准备

### 1. 目录结构
系统会自动创建以下目录：
```
项目根目录/
├── srt/              # 字幕文件目录
├── videos/           # 视频文件目录
├── clips/            # 输出短视频目录
└── analysis_cache/   # AI分析缓存目录
```

### 2. 字幕文件准备
将字幕文件放入 `srt/` 目录，文件名按集数顺序命名：

```
srt/
├── E01.srt          # 第1集字幕
├── E02.srt          # 第2集字幕
├── E03.srt          # 第3集字幕
├── 第4集.txt         # 支持中文命名
├── S01E05.srt       # 支持季集格式
...
```

**支持格式**: `.srt`, `.txt`
**命名要求**: 文件名按字符串排序应为播放顺序

### 3. 视频文件准备
将对应视频文件放入 `videos/` 目录：

```
videos/
├── E01.mp4          # 第1集视频
├── E02.mkv          # 支持多种格式
├── E03.avi
├── 第4集.mp4         # 文件名需与字幕文件对应
├── S01E05.wmv
...
```

**支持格式**: `.mp4`, `.mkv`, `.avi`, `.mov`, `.wmv`, `.flv`

## 🚀 快速开始

### 方法1: 直接运行（推荐）
点击页面上的 **"Run"** 按钮，或在终端执行：
```bash
python main.py
```

### 方法2: 交互式菜单
```bash
python main.py --menu
```

## 🤖 AI配置指南

### 第一次使用需要配置AI接口

#### 方式1: 官方API
支持 Google Gemini 和 OpenAI 官方API：

**Google Gemini 配置示例：**
```
API类型: 1 (官方API)
提供商: gemini
API密钥: 你的Gemini API Key
模型名称: gemini-2.0-flash-exp
```

**OpenAI 官方配置示例：**
```
API类型: 1 (官方API)
提供商: openai
API密钥: 你的OpenAI API Key
模型名称: gpt-4
```

#### 方式2: 中转API
支持各种中转服务：

**配置示例：**
```
API类型: 2 (中转API)
API地址: https://www.chataiapi.com/v1
API密钥: sk-xxxxxxxxxxxxxxxx
模型名称: deepseek-r1
```

## 📊 输出结果详解

### 1. 短视频文件
保存在 `clips/` 目录：
```
clips/
├── 第一集精彩开局_案件初现端倪_seg1.mp4
├── 第一集精彩开局_情感冲突爆发_seg2.mp4
├── 第一集精彩开局_悬念埋下伏笔_seg3.mp4
├── 第二集深入调查_真相逐步揭露_seg1.mp4
...
```

### 2. 旁白解说文件
每个短视频都有对应的旁白文件：
```
clips/
├── 第一集精彩开局_案件初现端倪_seg1_旁白解说.txt
├── 第一集精彩开局_案件初现端倪_seg1_旁白.txt
...
```

### 3. 分析缓存文件
AI分析结果会缓存，避免重复调用：
```
analysis_cache/
├── E01_abc123def.json
├── E02_def456ghi.json
...
```

## 🎯 核心功能详解

### 1. 智能剧情分析
- **自动识别剧情类型**: 法律剧、爱情剧、悬疑剧等
- **核心冲突识别**: 自动找出每集的主要矛盾点
- **情感高潮定位**: 精准识别情感爆发和转折点

### 2. 精彩片段选择
- **完整对话保证**: 确保每个片段包含完整的对话场景
- **时长智能控制**: 每个片段2-3分钟，适合短视频传播
- **剧情连贯性**: 多个片段组合能完整讲述本集故事

### 3. 专业旁白生成
- **剧情深度解说**: AI生成专业的剧情分析和背景介绍
- **字幕亮点提示**: 为精彩时刻生成吸引眼球的字幕
- **独立旁白文件**: 便于后期编辑和二次创作

### 4. 智能缓存机制
- **分析结果缓存**: 避免重复API调用，节省成本
- **断点续传**: 支持中断后继续处理
- **一致性保证**: 相同输入产生相同输出

## 🛠️ 高级功能

### 1. 菜单模式操作
```bash
python main.py --menu
```

**可用选项：**
- 配置AI接口
- 开始智能剪辑
- 查看文件状态
- 安装系统依赖
- 清空分析缓存

### 2. 系统维护
```bash
# 清空分析缓存（重新分析所有集数）
python main.py --menu
# 选择选项 5

# 安装必要依赖
python main.py --menu
# 选择选项 4
```

## 📝 最佳实践

### 1. 文件命名规范
- 字幕文件名应清晰表示集数顺序
- 视频文件名要与字幕文件对应
- 避免使用特殊符号，推荐使用下划线

### 2. AI模型选择建议
- **Gemini 2.0 Flash**: 速度快，成本低，推荐日常使用
- **GPT-4**: 分析质量高，适合高质量内容制作
- **DeepSeek R1**: 中文理解好，适合国产剧分析

### 3. 批量处理建议
- 先处理1-2集测试效果
- 确认配置正确后批量处理
- 定期清理缓存释放空间

## ❓ 常见问题解答

### Q: AI分析失败怎么办？
A: 检查API配置是否正确，网络是否通畅。系统支持断点续传，修复问题后可继续运行。

### Q: 找不到匹配的视频文件？
A: 确保视频文件名与字幕文件名基本一致，支持不同扩展名的智能匹配。

### Q: 短视频质量不满意？
A: 可以删除对应的缓存文件重新分析，或调整AI模型获得不同效果。

### Q: 系统运行很慢？
A: 首次运行需要AI分析较慢，后续会使用缓存大幅提速。可以考虑使用更快的AI模型。

### Q: 如何自定义剪辑参数？
A: 系统采用AI智能分析，会根据具体内容自动调整。如需深度定制，可以修改源码中的提示词。

## 🔧 技术要求

### 系统要求
- Python 3.7+
- FFmpeg（自动检测安装）
- 网络连接（用于AI API调用）

### 依赖包
系统会自动安装以下依赖：
- openai (用于中转API)
- google-generativeai (用于Gemini官方API)

## 📄 输出示例

### 短视频标题示例
```
第一集精彩开局_案件初现端倪_seg1.mp4
第一集精彩开局_情感冲突爆发_seg2.mp4
第二集深入调查_关键证据浮现_seg1.mp4
第二集深入调查_真相逐步揭露_seg2.mp4
```

### 旁白解说示例
```
📺 第一集精彩开局_案件初现端倪 - 专业旁白解说
============================================

🎬 片段信息:
• 标题: 第一集精彩开局_案件初现端倪
• 时长: 156 秒
• 剧情意义: 建立主要人物关系，引出核心案件

🎙️ 专业旁白解说稿:
在这个开场片段中，我们看到了主角律师的第一次出场，
通过一个看似简单的案件，巧妙地展现了主角的专业能力
和正义感，同时为后续的主线剧情埋下了重要的伏笔...
```

## 🚀 开始使用

1. **准备文件**: 将字幕放入 `srt/` 目录，视频放入 `videos/` 目录
2. **运行系统**: 点击 "Run" 按钮或执行 `python main.py`
3. **配置AI**: 首次使用需要配置AI接口
4. **开始剪辑**: 系统会自动分析并生成短视频
5. **查看结果**: 在 `clips/` 目录中查看生成的短视频和旁白文件

---

**🎉 祝您使用愉快！如有问题，请参考上述文档或查看系统日志输出。**
